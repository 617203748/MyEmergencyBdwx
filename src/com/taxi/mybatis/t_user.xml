<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.taxi.dao.UserDao">

    <select id="selectModel" parameterType="HashMap" resultType="T_user">
        SELECT
        `user_id`,
        `carlicense`,
        `realname`,
        `tel`,
        `username`,
        `password`,
        `company`,
        `type`,
        `num_today`,
        `num_totle`,
        `bind_device`,
        `bind_rongyun`,
        `time_create`,
        `time_update`
        FROM
        t_user
        WHERE 1=1
        <if test="user_id !=null">
            AND `user_id` = #{user_id}
        </if>
        <if test="carlicense !=null">
            AND `carlicense` = #{carlicense}
        </if>
        <if test="username !=null">
            AND `username` = #{username}
        </if>
        <if test="password !=null">
            AND `password` = #{password}
        </if>
        <if test="bind_device !=null">
            AND `bind_device` = #{bind_device}
        </if>
        <if test="type !=null">
            AND `type` = #{type}
        </if>
    </select>

    <update id="updateModel" parameterType="HashMap">
        UPDATE
        t_user
        SET
        `time_update` = #{time_update}
        <if test="bind_rongyun != null">
            ,`bind_rongyun` = #{bind_rongyun}
        </if>
        <if test="bind_device != null">
            ,`bind_device` = #{bind_device}
        </if>
        <if test="password != null">
            ,`password` = #{password}
        </if>
        <if test="num_today_add != null">
            ,`num_today` = num_today + 1
        </if>
        <if test="num_today_clear != null">
            ,`num_today` = 0
        </if>
        <if test="num_totle != null">
            ,`num_totle` = num_totle + num_today
        </if>
        WHERE
        1=1
        <if test="user_id != null">
            AND `user_id` = #{user_id}
        </if>
    </update>


    <select id="selectField_username" parameterType="HashMap"
            resultType="String">
        SELECT
        `username`
        FROM
        t_user
        WHERE
        1=1
        AND
        `username` != '-1'
        AND
        `bind_rongyun` != '-1'
        <if test="type != null">
            AND
            `type` = #{type}
        </if>
    </select>

</mapper>
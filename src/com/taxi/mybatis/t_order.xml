<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.taxi.dao.OrderDao">

    <insert id="insertModel" parameterType="T_order"
            useGeneratedKeys="true" keyProperty="order_id">
		INSERT INTO t_order
		(`serialnumber`,`tel_passenger`,`voice`,`is_push`,`time_create`)
		VALUES
		(#{serialnumber},#{tel_passenger},#{voice},#{is_push},#{time_create})
	</insert>

    <update id="updateModel" parameterType="HashMap">
        UPDATE
        t_order
        SET
        `time_update`=#{time_update}
        <if test="serialnumber !=null">
            ,`serialnumber` = #{serialnumber}
        </if>
        <if test="user_id !=null">
            ,`user_id` = #{user_id}
        </if>
        <if test="tel_passenger !=null">
            ,`tel_passenger` = #{tel_passenger}
        </if>
        <if test="voice !=null">
            ,`voice` = #{voice}
        </if>
        <if test="is_push !=null">
            ,`is_push` = #{is_push}
        </if>
        <if test="user_id !=null">
            ,`user_id` = #{user_id}
        </if>
        <if test="lon !=null">
            ,`lon` = #{lon}
        </if>
        <if test="lat !=null">
            ,`lat` = #{lat}
        </if>
        <if test="timecha !=null">
            ,`timecha` = #{timecha}
        </if>
        <if test="time_create !=null">
            ,`time_create` = #{time_create}
        </if>
        <if test="time_update !=null">
            ,`time_update` = #{time_update}
        </if>
        WHERE
        1=1
        <if test="order_id !=null">
            AND `order_id` = #{order_id}
        </if>

    </update>

    <select id="selectModelOne" parameterType="HashMap" resultType="T_order">
        SELECT
        `order_id`,
        `serialnumber`,
        `tel_passenger`,
        `voice`,
        `is_push`,
        `user_id`,
        `lon`,
        `lat`,
        `timecha`,
        `time_create`,
        `time_update`
        FROM
        t_order
        WHERE
        `order_id` = #{order_id}
    </select>
    <select id="selectModelList" parameterType="HashMap" resultType="T_order">
        SELECT
        `order_id`,
        `serialnumber`,
        `tel_passenger`,
        `voice`,
        `is_push`,
        `user_id`,
        `lon`,
        `lat`,
        `timecha`,
        `time_create`,
        `time_update`
        FROM
        t_order
        WHERE
        1=1
        <if test="order_id !=null">
            AND `order_id` = #{order_id}
        </if>
        <if test="user_id !=null">
            AND `user_id` = #{user_id}
        </if>
        <if test="today != null">
            AND `time_create` LIKE #{today}
        </if>
        <if test="start != null and end != null">
            ORDER BY `order_id` DESC
            LIMIT #{start},#{end}
        </if>
    </select>

    <select id="queryTodayCount" parameterType="HashMap" resultType="Integer">
		SELECT
		COUNT(order_id)
		FROM
		t_order
		WHERE
		time_create LIKE #{today}
	</select>


    <update id="seckillOrder" parameterType="HashMap">
        UPDATE
        t_order
        SET
        `time_update`=#{time_update},
        `user_id` = #{user_id},
        `timecha` = #{timecha},
        `lon` = #{lon},
        `lat` = #{lat}
        WHERE
        order_id
        =#{order_id}
        AND
        user_id = '-1'
    </update>
</mapper> 